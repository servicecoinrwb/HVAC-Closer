<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HVAC Sales Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.292.0/lucide.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
        }
        .btn-primary {
            background-color: #2563eb;
            color: white;
        }
        .btn-primary:hover {
            background-color: #1d4ed8;
        }
        .btn-secondary {
            background-color: #e5e7eb;
            color: #374151;
        }
        .btn-secondary:hover {
            background-color: #d1d5db;
        }
        .input-field {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            transition: border-color 0.2s;
        }
        .input-field:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.2);
        }
        .proposal-card {
            border: 2px solid #e5e7eb;
            transition: all 0.3s ease;
        }
        .proposal-card.best {
            border-color: #2563eb;
            box-shadow: 0 10px 15px -3px rgb(37 99 235 / 0.2), 0 4px 6px -4px rgb(37 99 235 / 0.2);
        }
        .tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div id="app" class="max-w-7xl mx-auto">
        <!-- Header -->
        <header class="flex items-center justify-between mb-8">
            <div class="flex items-center gap-3">
                <div class="bg-blue-600 p-3 rounded-lg text-white">
                    <i data-lucide="wind"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-bold text-gray-800">HVAC Sales Tool</h1>
                    <p class="text-gray-500">Streamline your sales process.</p>
                </div>
            </div>
            <button id="resetBtn" class="btn btn-secondary">
                <i data-lucide="rotate-cw" class="mr-2 h-4 w-4"></i>
                Start New Proposal
            </button>
        </header>

        <!-- Main Content -->
        <main>
            <!-- Step 1: Customer & Home Info -->
            <div class="card">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center"><span class="bg-blue-100 text-blue-700 rounded-full h-8 w-8 flex items-center justify-center font-bold mr-3">1</span> Job Details</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div>
                        <label for="customerName" class="block text-sm font-medium text-gray-700 mb-1">Customer Name</label>
                        <input type="text" id="customerName" class="input-field" placeholder="e.g., John Doe">
                    </div>
                    <div>
                        <label for="customerAddress" class="block text-sm font-medium text-gray-700 mb-1">Address</label>
                        <input type="text" id="customerAddress" class="input-field" placeholder="e.g., 123 Main St, Anytown">
                    </div>
                    <div>
                        <label for="jobType" class="block text-sm font-medium text-gray-700 mb-1">Job Type</label>
                        <select id="jobType" class="input-field">
                            <option value="furnace_ac">Furnace & AC</option>
                            <option value="heatpump_airhandler">Heat Pump & Air Handler</option>
                            <option value="ac_only">AC Only</option>
                            <option value="furnace_only">Furnace Only</option>
                        </select>
                    </div>
                    <div>
                        <label for="systemSize" class="block text-sm font-medium text-gray-700 mb-1">Required System Size (Tons)</label>
                        <select id="systemSize" class="input-field">
                            <option value="">Select Tonnage</option>
                            <option value="1.5">1.5 Tons</option>
                            <option value="2">2 Tons</option>
                            <option value="2.5">2.5 Tons</option>
                            <option value="3">3 Tons</option>
                            <option value="3.5">3.5 Tons</option>
                            <option value="4">4 Tons</option>
                            <option value="5">5 Tons</option>
                        </select>
                    </div>
                    <div>
                        <label for="laborHours" class="block text-sm font-medium text-gray-700 mb-1">Estimated Labor (Hours)</label>
                        <input type="number" id="laborHours" class="input-field" placeholder="e.g., 8">
                    </div>
                    <div>
                        <label for="miscMaterials" class="block text-sm font-medium text-gray-700 mb-1">Misc. Materials Cost ($)</label>
                        <input type="number" id="miscMaterials" class="input-field" placeholder="e.g., 450">
                    </div>
                    <div class="lg:col-span-3">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Customer Priorities (Select all that apply)</label>
                        <div class="flex flex-wrap gap-3 mt-2">
                            <button class="priority-btn btn btn-secondary" data-priority="Energy Savings"><i data-lucide="zap" class="mr-2 h-4 w-4"></i>Energy Savings</button>
                            <button class="priority-btn btn btn-secondary" data-priority="Improved Comfort"><i data-lucide="thermometer-sun" class="mr-2 h-4 w-4"></i>Improved Comfort</button>
                            <button class="priority-btn btn btn-secondary" data-priority="Quiet Operation"><i data-lucide="volume-x" class="mr-2 h-4 w-4"></i>Quiet Operation</button>
                            <button class="priority-btn btn btn-secondary" data-priority="Air Quality"><i data-lucide="leaf" class="mr-2 h-4 w-4"></i>Air Quality</button>
                            <button class="priority-btn btn btn-secondary" data-priority="Budget"><i data-lucide="dollar-sign" class="mr-2 h-4 w-4"></i>Budget</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 2: Build System -->
            <div class="card text-center">
                 <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center justify-center"><span class="bg-blue-100 text-blue-700 rounded-full h-8 w-8 flex items-center justify-center font-bold mr-3">2</span> Generate Proposal</h2>
                <button id="buildSystemBtn" class="btn btn-primary btn-lg">
                    <i data-lucide="settings-2" class="mr-2 h-5 w-5"></i>
                    Build System Options
                </button>
            </div>

            <!-- Step 3: Proposal -->
            <div id="proposalSection" class="hidden">
                <div class="card">
                    <h2 class="text-xl font-bold text-gray-800 mb-2 flex items-center"><span class="bg-blue-100 text-blue-700 rounded-full h-8 w-8 flex items-center justify-center font-bold mr-3">3</span> Your Custom Proposal</h2>
                    <p class="text-gray-600 mb-6">Here are three tailored options based on your home's needs and priorities.</p>
                    
                    <div id="proposalOutput" class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Proposal cards will be inserted here -->
                    </div>
                </div>

                <!-- Financing Calculator -->
                <div class="card">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center"><i data-lucide="calculator" class="mr-3 text-blue-600"></i>Financing Calculator</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-end">
                        <div>
                            <label for="loanAmount" class="block text-sm font-medium text-gray-700 mb-1">Investment Amount</label>
                            <input type="number" id="loanAmount" class="input-field" placeholder="Enter total price">
                        </div>
                        <div>
                            <label for="loanTerm" class="block text-sm font-medium text-gray-700 mb-1">Loan Term (Years)</label>
                            <select id="loanTerm" class="input-field">
                                <option value="3">3 Years</option>
                                <option value="5">5 Years</option>
                                <option value="7">7 Years</option>
                                <option value="10">10 Years</option>
                            </select>
                        </div>
                        <div class="text-center">
                             <button id="calculatePaymentBtn" class="btn btn-primary w-full">Calculate Payment</button>
                        </div>
                    </div>
                    <div id="paymentResult" class="mt-6 text-center hidden">
                        <p class="text-gray-600">Estimated Monthly Payment:</p>
                        <p class="text-4xl font-bold text-blue-600" id="monthlyPayment"></p>
                        <p class="text-xs text-gray-500 mt-1">Based on an estimated 9.99% APR. For estimation purposes only.</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const equipmentData = {
            "furnaces": {
                "modulating": [{"item": "G97CMN0801714A", "desc": "97% 3-1/2T 80mbh Modulating Ion", "price": 3887.17}],
                "2-stage": [{"item": "G96CTN0801714A", "desc": "96% 3-1/2T 80mbh 2-Stage Ion", "price": 3205.74}],
                "performance": [{"item": "N95ESN0801716A", "desc": "96% 4T 80mbh ECM Performance", "price": 2186.63}]
            },
            "ac": {
                "variable-speed": [{"item": "HVA936GK", "desc": "3T Varispeed 19 SEER2 Ion", "size": 3, "price": 5421.14}],
                "2-stage": [{"item": "N4A7T36AKA", "desc": "3T 17 SEER2 2-Stage", "size": 3, "price": 3198.17}],
                "1-stage-16": [{"item": "N4A5S36AKA", "desc": "3T 16 SEER2 1-Stage", "size": 3, "price": 2613.66}]
            },
             "heatPumps": {
                "variable-speed": [{"item": "HVH836GKA", "desc": "3T Varispeed 19 SEER2 HP", "size": 3, "price": 7694.46}],
                "2-stage": [{"item": "N4H7T36AKAAA", "desc": "3T 17 SEER2 2-Stage HP", "size": 3, "price": 5913.29}],
                "1-stage-15": [{"item": "N4H5S36AKAAA", "desc": "3T 15 SEER 1-Stage HP", "size": 3, "price": 4790.82}]
            },
            "fanCoils": {
                 "communicating": [{"item": "FCM4X3600AL", "desc": "3T Communicating Fan Coil", "size": 3, "price": 2984.66}],
                 "ecm-5-speed": [{"item": "FJMA4X36L0BB", "desc": "3T ECM 5-Speed Fan Coil", "size": 3, "price": 2233.57}]
            },
            "coils": [
                {"item": "EVD4X18M14A", "size": 1.5, "price": 651.14},
                {"item": "EVD4X24M14A", "size": 2, "price": 696.57},
                {"item": "EVD4X30M14A", "size": 2.5, "price": 767.74},
                {"item": "EVD4X36M17A", "size": 3, "price": 764.71},
                {"item": "EVD4X42M17A", "size": 3.5, "price": 894.94},
                {"item": "EVD4X48M21A", "size": 4, "price": 958.54},
                {"item": "EVD4X60M24A", "size": 5, "price": 1099.37}
            ],
            "accessories": {
                "thermostat": {"item": "SYST0101CW", "desc": "Ion Wall Control WiFi Touchscreen", "price": 747.21}
            }
        };

        function initializeApp() {
            lucide.createIcons();

            const buildSystemBtn = document.getElementById('buildSystemBtn');
            const proposalSection = document.getElementById('proposalSection');
            const proposalOutput = document.getElementById('proposalOutput');
            const systemSizeSelect = document.getElementById('systemSize');
            const jobTypeSelect = document.getElementById('jobType');
            const laborHoursInput = document.getElementById('laborHours');
            const miscMaterialsInput = document.getElementById('miscMaterials');
            const priorityBtns = document.querySelectorAll('.priority-btn');
            const calculatePaymentBtn = document.getElementById('calculatePaymentBtn');
            const resetBtn = document.getElementById('resetBtn');

            const LABOR_RATE = 125; 
            let selectedPriorities = [];
            
            priorityBtns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const priority = btn.dataset.priority;
                    btn.classList.toggle('btn-secondary');
                    btn.classList.toggle('btn-primary');
                    if (selectedPriorities.includes(priority)) {
                        selectedPriorities = selectedPriorities.filter(p => p !== priority);
                    } else {
                        selectedPriorities.push(priority);
                    }
                });
            });

            buildSystemBtn.addEventListener('click', () => {
                const tonnage = parseFloat(systemSizeSelect.value);
                const laborHours = parseFloat(laborHoursInput.value) || 0;
                const miscMaterials = parseFloat(miscMaterialsInput.value) || 0;
                const jobType = jobTypeSelect.value;

                if (!tonnage && jobType !== 'furnace_only') {
                    alert('Please select a system size.');
                    return;
                }
                
                generateProposal(jobType, tonnage, laborHours, miscMaterials);
                proposalSection.classList.remove('hidden');
            });

            calculatePaymentBtn.addEventListener('click', () => {
                const loanAmount = parseFloat(document.getElementById('loanAmount').value);
                const loanTerm = parseInt(document.getElementById('loanTerm').value);
                
                if (!loanAmount || !loanTerm) {
                    alert('Please enter a valid investment amount.');
                    return;
                }

                const interestRate = 0.0999;
                const monthlyRate = interestRate / 12;
                const numberOfPayments = loanTerm * 12;

                const monthlyPayment = loanAmount * (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments)) / (Math.pow(1 + monthlyRate, numberOfPayments) - 1);

                document.getElementById('monthlyPayment').textContent = `$${monthlyPayment.toFixed(2)}`;
                document.getElementById('paymentResult').classList.remove('hidden');
            });

            resetBtn.addEventListener('click', () => {
                document.getElementById('customerName').value = '';
                document.getElementById('customerAddress').value = '';
                jobTypeSelect.value = 'furnace_ac';
                systemSizeSelect.value = '';
                laborHoursInput.value = '';
                miscMaterialsInput.value = '';
                proposalSection.classList.add('hidden');
                proposalOutput.innerHTML = '';
                document.getElementById('paymentResult').classList.add('hidden');
                document.getElementById('loanAmount').value = '';
                selectedPriorities = [];
                priorityBtns.forEach(btn => {
                    btn.classList.remove('btn-primary');
                    btn.classList.add('btn-secondary');
                });
            });

            function findClosest(arr, size) {
                return arr.reduce((prev, curr) => Math.abs(curr.size - size) < Math.abs(prev.size - size) ? curr : prev);
            }

            function generateProposal(jobType, tonnage, laborHours, miscMaterials) {
                let packages = [];
                const thermostat = equipmentData.accessories.thermostat;

                switch (jobType) {
                    case 'furnace_ac':
                        packages = [
                            { title: "Performance", level: "Good", color: "gray", items: [equipmentData.furnaces.performance[0], findClosest(equipmentData.ac['1-stage-16'], tonnage), findClosest(equipmentData.coils, tonnage)], features: ["Reliable Operation", "Standard Efficiency", "Budget-Friendly"] },
                            { title: "Comfort Series", level: "Better", color: "blue", items: [equipmentData.furnaces['2-stage'][0], findClosest(equipmentData.ac['2-stage'], tonnage), findClosest(equipmentData.coils, tonnage), thermostat], features: ["Enhanced Comfort", "Higher Energy Savings", "Quieter Operation", "Advanced Control"] },
                            { title: "Ion Ultimate", level: "Best", color: "indigo", items: [equipmentData.furnaces.modulating[0], findClosest(equipmentData.ac['variable-speed'], tonnage), findClosest(equipmentData.coils, tonnage), thermostat], features: ["Maximum Energy Savings", "Ultimate Comfort Control", "Whisper-Quiet Performance", "Smart Communicating System"] }
                        ];
                        break;
                    case 'heatpump_airhandler':
                        packages = [
                             { title: "Performance HP", level: "Good", color: "gray", items: [findClosest(equipmentData.heatPumps['1-stage-15'], tonnage), findClosest(equipmentData.fanCoils['ecm-5-speed'], tonnage)], features: ["Reliable All-in-One System", "Standard Efficiency", "Budget-Friendly"] },
                             { title: "Comfort Series HP", level: "Better", color: "blue", items: [findClosest(equipmentData.heatPumps['2-stage'], tonnage), findClosest(equipmentData.fanCoils['ecm-5-speed'], tonnage), thermostat], features: ["Enhanced Comfort & Dehumidification", "Higher Energy Savings", "Advanced Control"] },
                             { title: "Ion Ultimate HP", level: "Best", color: "indigo", items: [findClosest(equipmentData.heatPumps['variable-speed'], tonnage), findClosest(equipmentData.fanCoils.communicating, tonnage), thermostat], features: ["Maximum Energy Savings", "Ultimate Comfort Control", "Whisper-Quiet Performance", "Smart Communicating System"] }
                        ];
                        break;
                    case 'ac_only':
                         packages = [
                            { title: "Performance AC", level: "Good", color: "gray", items: [findClosest(equipmentData.ac['1-stage-16'], tonnage), findClosest(equipmentData.coils, tonnage)], features: ["Reliable Cooling", "Standard Efficiency", "Budget-Friendly"] },
                            { title: "Comfort Series AC", level: "Better", color: "blue", items: [findClosest(equipmentData.ac['2-stage'], tonnage), findClosest(equipmentData.coils, tonnage), thermostat], features: ["Enhanced Dehumidification", "Higher Energy Savings", "Quieter Operation"] },
                            { title: "Ion Ultimate AC", level: "Best", color: "indigo", items: [findClosest(equipmentData.ac['variable-speed'], tonnage), findClosest(equipmentData.coils, tonnage), thermostat], features: ["Maximum Energy Savings", "Ultimate Cooling Comfort", "Whisper-Quiet Performance"] }
                        ];
                        break;
                    case 'furnace_only':
                         packages = [
                            { title: "Performance Furnace", level: "Good", color: "gray", items: [equipmentData.furnaces.performance[0]], features: ["Reliable Heating", "Standard Efficiency", "Budget-Friendly"] },
                            { title: "Comfort Series Furnace", level: "Better", color: "blue", items: [equipmentData.furnaces['2-stage'][0], thermostat], features: ["Consistent Temperatures", "Higher Energy Savings", "Quieter Operation"] },
                            { title: "Ion Ultimate Furnace", level: "Best", color: "indigo", items: [equipmentData.furnaces.modulating[0], thermostat], features: ["Maximum Energy Savings", "Ultimate Heating Comfort", "Precise Temperature Control"] }
                        ];
                        break;
                }

                proposalOutput.innerHTML = '';
                packages.forEach(pkg => {
                    const equipmentTotal = pkg.items.reduce((sum, item) => sum + item.price, 0);
                    const laborTotal = laborHours * LABOR_RATE;
                    const finalPrice = equipmentTotal + laborTotal + miscMaterials;

                    const cardHTML = `
                        <div class="card proposal-card ${pkg.level.toLowerCase()}">
                            <div class="text-center">
                                <span class="tag bg-${pkg.color}-100 text-${pkg.color}-700">${pkg.level}</span>
                                <h3 class="text-2xl font-bold text-gray-800 mt-3">${pkg.title}</h3>
                                <div class="my-6">
                                    <span class="text-4xl font-extrabold text-gray-900">$${finalPrice.toFixed(2)}</span>
                                    <span class="text-gray-500"> / installed</span>
                                </div>
                            </div>
                            <div class="mb-6">
                                <h4 class="font-semibold text-gray-700 mb-3">Key Features:</h4>
                                <ul class="space-y-2">
                                    ${pkg.features.map(f => `<li class="flex items-center text-gray-600"><i data-lucide="check-circle" class="h-5 w-5 text-green-500 mr-2"></i>${f}</li>`).join('')}
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-3">Equipment Included:</h4>
                                <ul class="space-y-2 text-sm text-gray-500">
                                    ${pkg.items.map(i => `<li><strong>${i.item}:</strong> ${i.desc}</li>`).join('')}
                                </ul>
                            </div>
                        </div>
                    `;
                    proposalOutput.innerHTML += cardHTML;
                });
                lucide.createIcons();
            }
        }

        function waitForLucide() {
            if (typeof lucide !== 'undefined') {
                initializeApp();
            } else {
                setTimeout(waitForLucide, 50);
            }
        }

        waitForLucide();
    </script>
</body>
</html>
